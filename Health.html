<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Health Log</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#FDFCF9;
  --card:#FFFFFF;
  --accent:#9CAF88;
  --danger:#F87171;
  --text:#1F2937;
  --muted:#6B7280;
}

*{box-sizing:border-box;font-family:Inter,sans-serif}

body{
  margin:0;
  background:var(--bg);
  padding:24px 16px 80px;
}

.liveTime{
  position:fixed;
  top:14px;
  right:18px;
  font-size:13px;
  color:var(--muted);
}

.streak{
  position:fixed;
  top:14px;
  left:18px;
  font-size:13px;
  color:#EA580C;
}

.card{
  max-width:520px;
  margin:70px auto 0;
  background:var(--card);
  border-radius:32px;
  padding:32px;
  box-shadow:0 25px 60px rgba(0,0,0,.08);
}

h1{
  font-family:"Playfair Display",serif;
  margin:0 0 20px;
}

label{
  font-size:13px;
  color:var(--muted);
  margin-top:18px;
  display:block;
}

input,textarea{
  width:100%;
  padding:14px;
  border-radius:18px;
  border:1px solid rgba(0,0,0,.05);
  margin-top:6px;
}

input[readonly]{background:#F3F4F6}

.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

textarea{resize:none}

button{
  width:100%;
  margin-top:28px;
  padding:16px;
  border-radius:30px;
  border:none;
  background:var(--accent);
  color:#fff;
  font-size:16px;
  font-weight:600;
  transition:.3s;
}

button.success{background:#16A34A}
button.error{background:#DC2626}

.msg{
  margin-top:12px;
  font-size:13px;
  text-align:center;
}

.footer{
  text-align:center;
  margin-top:24px;
  font-size:12px;
  color:#9CA3AF;
}
</style>
</head>

<body>

<div class="liveTime" id="liveTime"></div>
<div class="streak" id="streak">ðŸ”¥ Streak: 0</div>

<div class="card">
<h1>Daily Health Log</h1>

<label>Date</label>
<input type="date" id="date">

<div class="row">
  <div>
    <label>Sleep Time</label>
    <input type="time" id="sleep">
  </div>
  <div>
    <label>Wake Time</label>
    <input type="time" id="wake">
  </div>
</div>

<label>Sleep Hours</label>
<input id="sleepHrs" readonly>

<div class="row">
  <div>
    <label>Work Login</label>
    <input type="time" id="login">
  </div>
  <div>
    <label>Work Logout</label>
    <input type="time" id="logout">
  </div>
</div>

<label>Work Hours</label>
<input id="workHrs" readonly>

<div class="row">
  <div>
    <label>Steps</label>
    <input id="steps" type="number">
  </div>
  <div>
    <label>Workout (min)</label>
    <input id="workout" type="number">
  </div>
</div>

<div class="row">
  <div>
    <label>Water (L)</label>
    <input id="water" type="number" step="0.1">
  </div>
  <div>
    <label>Screen Time (hrs)</label>
    <input id="screen" type="number" step="0.1">
  </div>
</div>

<label>Weight (kg)</label>
<input id="weight">

<label>Notes</label>
<textarea id="notes" rows="2"></textarea>

<button id="save">Save Health Log</button>
<div class="msg" id="msg"></div>

<div class="footer">
Â© Designed & Engineered by <strong>Kaiwalya Muley</strong>
</div>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbwJZKpjsMiyFG9F022EbeQFVWi-PINF0_zZbVo_WzisNwbQeNQ4mWUQp1oqqyFe_-ra/exec";

const d=new Date();
date.value=d.toISOString().slice(0,10);

function mins(t){
  if(!t)return null;
  const[a,b]=t.split(":").map(Number);
  return a*60+b;
}

function calc(){
  if(sleep.value&&wake.value){
    let diff=mins(wake.value)-mins(sleep.value);
    if(diff<=0)diff+=1440;
    sleepHrs.value=(diff/60).toFixed(2);
  }
  if(login.value&&logout.value){
    let diff=mins(logout.value)-mins(login.value);
    if(diff>0)workHrs.value=(diff/60).toFixed(2);
  }
}

sleep.onchange=wake.onchange=login.onchange=logout.onchange=calc;

setInterval(()=>{
  liveTime.textContent=new Date().toLocaleString("en-IN",{
    weekday:"long",day:"2-digit",month:"short",
    year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"
  });
},1000);

save.onclick=async()=>{
  msg.textContent="";
  save.textContent="Savingâ€¦";

  const res=await fetch(API,{
    method:"POST",
    body:JSON.stringify({
      entryDate:date.value,
      sleepTime:sleep.value,
      wakeTime:wake.value,
      workLogin:login.value,
      workLogout:logout.value,
      steps:steps.value,
      workoutMin:workout.value,
      waterLiters:water.value,
      screenTime:screen.value,
      weightKg:weight.value,
      notes:notes.value
    })
  });

  const t=await res.text();
  if(t==="DUPLICATE"){
    msg.textContent="Health log already exists for this date.";
    save.className="error";
    save.textContent="Already Saved";
    return;
  }

  save.className="success";
  save.textContent="Saved âœ“";
};
</script>

</body>
</html>
