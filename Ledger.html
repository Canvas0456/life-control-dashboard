<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Account Ledger</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg:#F7F8FC;
  --card:#FFFFFF;
  --border:#E5E7EB;
  --text:#374151;
  --muted:#6B7280;
  --debit:#E4989B;
  --credit:#84A98C;
}

* { box-sizing:border-box; font-family:system-ui,Segoe UI,Roboto; }

body {
  margin:0;
  background:var(--bg);
  padding:32px 16px;
  color:var(--text);
}

h1 { margin:0 0 16px; }

.card {
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:20px;
  margin-bottom:20px;
}

select {
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid var(--border);
}

table {
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}

thead th {
  text-align:left;
  padding:10px;
  border-bottom:1px solid var(--border);
  color:var(--muted);
  position:sticky;
  top:0;
  background:#FFF;
}

tbody td {
  padding:10px;
  border-bottom:1px dashed var(--border);
}

td.debit { color:var(--debit); }
td.credit { color:var(--credit); }
td.balance { font-weight:600; }

.right { text-align:right; }

@media(max-width:768px){
  table { font-size:12px; }
}
</style>
</head>

<body>

<h1>Account Ledger</h1>

<div class="card">
  <label>Select Account</label>
  <select id="accountSelect"></select>
</div>

<div class="card">
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Txn ID</th>
        <th>Type</th>
        <th>Category</th>
        <th class="right">Debit</th>
        <th class="right">Credit</th>
        <th class="right">Balance</th>
      </tr>
    </thead>
    <tbody id="ledgerBody">
      <tr><td colspan="7"><em>Select an account</em></td></tr>
    </tbody>
  </table>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbzFrvs7pVyW7HCciqHeNF_1oQVCScJkH_6gem3YXt5lVyxjfJXh36wOXYIRYIho4gGz/exec";

const accountSelect = document.getElementById("accountSelect");
const ledgerBody = document.getElementById("ledgerBody");

async function init() {
  const accounts = await fetch(API + "?action=accounts").then(r => r.json());
  accountSelect.innerHTML = "<option value=''>Select</option>" +
    accounts.map(a => `<option>${a}</option>`).join("");
}
init();

accountSelect.onchange = async () => {
  if (!accountSelect.value) return;

  ledgerBody.innerHTML = "<tr><td colspan='7'>Loading…</td></tr>";

  const data = await fetch(API + "?action=ledger&account=" + encodeURIComponent(accountSelect.value))
    .then(r => r.json());

  if (!data.length) {
    ledgerBody.innerHTML = "<tr><td colspan='7'><em>No data</em></td></tr>";
    return;
  }

  ledgerBody.innerHTML = data.map(r => `
    <tr>
      <td>${r.date}</td>
      <td>${r.txnId}</td>
      <td>${r.type}</td>
      <td>${r.category}</td>
      <td class="right debit">${r.debit ? "₹ " + r.debit : ""}</td>
      <td class="right credit">${r.credit ? "₹ " + r.credit : ""}</td>
      <td class="right balance">₹ ${r.balance}</td>
    </tr>
  `).join("");
};
</script>

</body>
</html>
