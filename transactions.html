<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Daily Money Log</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
:root {
  --bg1:#F7F8FC; --bg2:#EEF2F7;
  --card:#FFFFFF; --border:#E5E7EB;
  --text:#374151;
  --accent:#9AA7D8;
  --radius:14px;
}

* { box-sizing:border-box; font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif; }

body {
  margin:0;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
  color:var(--text);
  min-height:100vh;
  padding:80px 16px 40px;
}

.clock {
  position:fixed;
  top:16px; right:20px;
  font-size:13px; color:#6B7280;
}

.container {
  max-width:1100px;
  margin:auto;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:24px;
  animation:fadeUp .5s ease;
}

h1 {
  grid-column:span 2;
  font-size:24px;
  margin:0;
}

.subtle { color:#6B7280; font-size:13px; }

.card {
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:24px;
}

/* BALANCES */
.balances {
  grid-column:span 2;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:16px;
}

.balance-card {
  padding:16px;
  border-radius:12px;
  border:1px solid var(--border);
}

.balance-card div:first-child {
  font-size:12px; color:#6B7280;
}

.balance-card div:last-child {
  font-size:18px; font-weight:600;
  margin-top:6px;
}

/* FORM */
label { font-size:13px; font-weight:500; margin-bottom:6px; display:block; }
.field { margin-bottom:18px; }

input,select {
  width:100%; padding:10px 12px;
  border-radius:8px;
  border:1px solid var(--border);
  font-size:14px;
}

input[readonly] { background:#F3F4F6; }

button {
  width:100%; padding:12px;
  border:none; border-radius:10px;
  background:var(--accent);
  color:#fff; font-weight:600;
}

.hidden { display:none; }

/* TRANSACTIONS LIST */
.txn {
  display:flex;
  justify-content:space-between;
  font-size:13px;
  padding:8px 0;
  border-bottom:1px dashed #E5E7EB;
}

/* MOBILE */
@media(max-width:900px){
  .container { grid-template-columns:1fr; }
  h1,.balances { grid-column:span 1; }
}

/* COLLAPSIBLE */
.accordion { cursor:pointer; font-weight:600; margin-bottom:8px; }
</style>
</head>

<body>

<div class="clock" id="clock"></div>

<div class="container">

<h1>Daily Money Log</h1>

<!-- BALANCES -->
<div class="balances" id="balances"></div>

<!-- FORM -->
<div class="card">
<form id="txnForm">

<div class="field">
<label>Date</label>
<input type="date" id="txnDate" required>
</div>

<div class="field">
<label>Type</label>
<select id="txnType" required>
<option value="">Select</option>
<option value="INCOME">Income</option>
<option value="EXP">Expense</option>
<option value="EMI">EMI Payment</option>
<option value="SAVINGS">Savings</option>
<option value="TRANSFER">Transfer</option>
</select>
</div>

<div class="field">
<label>Category</label>
<select id="category"></select>
</div>

<div class="field hidden" id="subBlock">
<label>Sub Category</label>
<select id="subCategory"></select>
</div>

<div class="field">
<label>Amount</label>
<input type="number" id="amount" required>
</div>

<div class="field hidden" id="emiBlock">
<label>EMI</label>
<select id="emiId"></select>
</div>

<div class="field hidden" id="fromBlock">
<label>From Account</label>
<select id="fromAccount"></select>
</div>

<div class="field hidden" id="toBlock">
<label>To Account</label>
<select id="toAccount"></select>
</div>

<button type="submit">Save Transaction</button>
</form>
</div>

<!-- LAST 10 -->
<div class="card" id="txnPanel">
<div class="accordion" onclick="toggleTxns()">Last 10 Transactions</div>
<div id="recentTxns"></div>
</div>

<div class="subtle" style="grid-column:span 2;text-align:center;">
© Kaiwalya Muley
</div>

</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbzFrvs7pVyW7HCciqHeNF_1oQVCScJkH_6gem3YXt5lVyxjfJXh36wOXYIRYIho4gGz/exec";

/* CLOCK */
setInterval(()=>clock.textContent=new Date().toLocaleString("en-IN",{weekday:"short",day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),1000);

/* BALANCES */
fetch(API_URL+"?action=balances")
.then(r=>r.json()).then(d=>{
  const b=document.getElementById("balances");
  (d||[]).forEach(a=>{
    b.innerHTML+=`<div class="balance-card"><div>${a.account}</div><div>₹ ${a.balance}</div></div>`;
  });
}).catch(()=>{});

/* COLLAPSIBLE */
function toggleTxns(){
  const r=document.getElementById("recentTxns");
  r.style.display=r.style.display==="none"?"block":"none";
}
if(window.innerWidth<900) recentTxns.style.display="none";
</script>

</body>
</html>
