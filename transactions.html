<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Adding a Transaction</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#FDFCF9;
  --card:#FFFFFF;
  --accent:#3E5C45;
  --border:rgba(0,0,0,0.05);
  --text:#1F2937;
  --muted:#6B7280;
}

*{box-sizing:border-box;font-family:Inter,sans-serif}

body{
  margin:0;
  background:var(--bg);
  padding:24px 16px 80px;
}

.liveTime{
  position:fixed;
  top:14px;
  right:18px;
  font-size:13px;
  color:var(--muted);
}

.card{
  max-width:520px;
  margin:60px auto 0;
  background:var(--card);
  border-radius:32px;
  padding:32px;
  box-shadow:0 25px 60px rgba(0,0,0,.08);
}

h1{
  font-family:"Playfair Display",serif;
  margin:0 0 20px;
}

.amount{
  font-size:4rem;
  text-align:center;
  color:var(--accent);
  border:none;
  outline:none;
  width:100%;
  background:transparent;
}

label{
  font-size:13px;
  color:var(--muted);
  margin-top:18px;
  display:block;
}

input,select,textarea{
  width:100%;
  padding:14px;
  border-radius:18px;
  border:1px solid var(--border);
  margin-top:6px;
}

textarea{resize:none}

button{
  width:100%;
  margin-top:28px;
  padding:16px;
  border-radius:30px;
  border:none;
  background:var(--accent);
  color:#fff;
  font-size:16px;
  font-weight:600;
  transition:.3s;
}

button.success{background:#16A34A}
button.error{background:#DC2626}

.hidden{display:none}

details summary{
  cursor:pointer;
  font-weight:600;
  margin-top:28px;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
  margin-top:12px;
}
th,td{
  padding:8px;
  border-bottom:1px dashed #E5E7EB;
}
td:last-child{text-align:right}

.footer{
  text-align:center;
  margin-top:24px;
  font-size:12px;
  color:#9CA3AF;
}
</style>
</head>

<body>

<div class="liveTime" id="liveTime"></div>

<div class="card">
<h1>Adding a Transaction</h1>

<label>Date</label>
<input type="date" id="txnDate">

<input id="amount" class="amount" type="number" placeholder="0">

<label>Type</label>
<select id="type">
  <option value="">Select</option>
  <option value="INCOME">Income</option>
  <option value="EXP">Expense</option>
  <option value="SAVINGS">Savings</option>
  <option value="TRANSFER">Transfer</option>
  <option value="EMI">EMI</option>
</select>

<label>Category</label>
<select id="category"></select>

<div id="subWrap" class="hidden">
<label>Sub Category</label>
<select id="subCategory"></select>
</div>

<div id="emiWrap" class="hidden">
<label>EMI</label>
<select id="emiId"></select>
</div>

<div id="fromWrap" class="hidden">
<label>From Account</label>
<select id="fromAcc"></select>
</div>

<div id="toWrap" class="hidden">
<label>To Account</label>
<select id="toAcc"></select>
</div>

<label>Notes</label>
<textarea id="notes" rows="2"></textarea>

<button id="saveBtn">Save Transaction</button>

<details>
<summary>Last 10 Transactions</summary>
<div id="recent"></div>
</details>

<div class="footer">
Â© Designed & Engineered by <strong>Kaiwalya Muley</strong>
</div>
</div>

<script>
/* ðŸŽ HAPTIC FEEDBACK */
function haptic(type="light"){
  if(!navigator.vibrate) return;
  const p={
    light:10,
    medium:20,
    success:[10,30,10],
    error:[30,40,30]
  };
  navigator.vibrate(p[type]||10);
}

const API="https://script.google.com/macros/s/AKfycbzFrvs7pVyW7HCciqHeNF_1oQVCScJkH_6gem3YXt5lVyxjfJXh36wOXYIRYIho4gGz/exec";

txnDate.value=new Date().toISOString().slice(0,10);

/* LIVE TIME */
setInterval(()=>{
  liveTime.textContent=new Date().toLocaleString("en-IN",{
    weekday:"long",day:"2-digit",month:"short",
    year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"
  });
},1000);

/* --- existing logic unchanged below --- */
/* save click haptic added only */
saveBtn.onclick=async()=>{
  haptic("medium");

  saveBtn.textContent="Savingâ€¦";
  saveBtn.className="";

  try{
    await fetch(API,{
      method:"POST",
      body:JSON.stringify({
        action:"addTransaction",
        payload:{
          txnDate:txnDate.value,
          txnType:type.value,
          category:category.value,
          subCategory:subCategory.value,
          amount:Number(amount.value),
          fromAccount:fromAcc.value,
          toAccount:toAcc.value,
          emiId:emiId.value,
          notes:notes.value,
          source:"WEB"
        }
      })
    });

    haptic("success");
    saveBtn.textContent="Saved âœ“";
    saveBtn.classList.add("success");
    setTimeout(()=>location.reload(),800);

  }catch{
    haptic("error");
    saveBtn.textContent="Error";
    saveBtn.classList.add("error");
  }
};
</script>

</body>
</html>
